<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Scales and Transformations
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Univariate Exploration of Data
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Introduction.html">
       01. Introduction
      </a>
     </li>
     <li class="">
      <a href="02. Tidy Data.html">
       02. Tidy Data
      </a>
     </li>
     <li class="">
      <a href="03. Bar Charts.html">
       03. Bar Charts
      </a>
     </li>
     <li class="">
      <a href="04. Absolute vs. Relative Frequency.html">
       04. Absolute vs. Relative Frequency
      </a>
     </li>
     <li class="">
      <a href="05. Counting Missing Data.html">
       05. Counting Missing Data
      </a>
     </li>
     <li class="">
      <a href="06. Bar Chart Practice.html">
       06. Bar Chart Practice
      </a>
     </li>
     <li class="">
      <a href="07. Pie Charts.html">
       07. Pie Charts
      </a>
     </li>
     <li class="">
      <a href="08. Histograms.html">
       08. Histograms
      </a>
     </li>
     <li class="">
      <a href="09. Histogram Practice.html">
       09. Histogram Practice
      </a>
     </li>
     <li class="">
      <a href="10. Figures, Axes, and Subplots.html">
       10. Figures, Axes, and Subplots
      </a>
     </li>
     <li class="">
      <a href="11. Choosing a Plot for Discrete Data.html">
       11. Choosing a Plot for Discrete Data
      </a>
     </li>
     <li class="">
      <a href="12. Descriptive Statistics, Outliers and Axis Limits.html">
       12. Descriptive Statistics, Outliers and Axis Limits
      </a>
     </li>
     <li class="">
      <a href="13. Scales and Transformations.html">
       13. Scales and Transformations
      </a>
     </li>
     <li class="">
      <a href="14. Scales and Transformations Practice.html">
       14. Scales and Transformations Practice
      </a>
     </li>
     <li class="">
      <a href="15. Lesson Summary.html">
       15. Lesson Summary
      </a>
     </li>
     <li class="">
      <a href="16. Extra Kernel Density Estimation.html">
       16. Extra: Kernel Density Estimation
      </a>
     </li>
     <li class="">
      <a href="17. Extra Waffle Plots.html">
       17. Extra: Waffle Plots
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          13. Scales and Transformations
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
         <p>
          L3 121 Scales And Transformations V3
         </p>
        </h3>
        <video controls="">
         <source src="13. L3 121 Scales And Transformations V3-PE53ga2bOME.mp4" type="video/mp4"/>
         <track default="true" kind="subtitles" label="en" src="13. L3 121 Scales And Transformations V3-PE53ga2bOME.en.vtt" srclang="en"/>
         <track default="false" kind="subtitles" label="BR" src="13. L3 121 Scales And Transformations V3-PE53ga2bOME.pt-BR.vtt" srclang="BR"/>
         <track default="false" kind="subtitles" label="CN" src="13. L3 121 Scales And Transformations V3-PE53ga2bOME.zh-CN.vtt" srclang="CN"/>
        </video>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <hr/>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
         <p>
          DataVis L3 12 V2
         </p>
        </h3>
        <video controls="">
         <source src="13. DataVis L3 12 V2-fo0VIbQRBJk.mp4" type="video/mp4"/>
         <track default="true" kind="subtitles" label="en" src="13. DataVis L3 12 V2-fo0VIbQRBJk.en.vtt" srclang="en"/>
         <track default="false" kind="subtitles" label="BR" src="13. DataVis L3 12 V2-fo0VIbQRBJk.pt-BR.vtt" srclang="BR"/>
         <track default="false" kind="subtitles" label="CN" src="13. DataVis L3 12 V2-fo0VIbQRBJk.zh-CN.vtt" srclang="CN"/>
        </video>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <hr/>
         <h2 id="scales-and-transformations">
          Scales and Transformations
         </h2>
         <p>
          Certain data distributions will find themselves amenable to scale transformations. The most common example of this is data that follows an approximately
          <a href="https://en.wikipedia.org/wiki/Log-normal_distribution" rel="noopener noreferrer" target="_blank">
           log-normal
          </a>
          distribution. This is data that, in their natural units, can look highly skewed: lots of points with low values, with a very long tail of data points with large values. However, after applying a logarithmic transform to the data, the data will follow a normal distribution. (If you need a refresher on the logarithm function, check out
          <a href="https://www.khanacademy.org/math/algebra2/exponential-and-logarithmic-functions" rel="noopener noreferrer" target="_blank">
           this lesson on Khan Academy
          </a>
          .)
         </p>
         <pre><code class="python language-python">plt.figure(figsize = [10, 5])

# left histogram: data plotted in natural units
plt.subplot(1, 2, 1)
bin_edges = np.arange(0, data.max()+100, 100)
plt.hist(data, bins = bin_edges)
plt.xlabel('values')

# right histogram: data plotted after direct log transformation
plt.subplot(1, 2, 2)
log_data = np.log10(data) # direct data transform
log_bin_edges = np.arange(0.8, log_data.max()+0.1, 0.1)
plt.hist(log_data, bins = log_bin_edges)
plt.xlabel('log(values)')</code></pre>
         <p>
          (Documentation:
          <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.log10.html" rel="noopener noreferrer" target="_blank">
           numpy
           <code>
            log10
           </code>
          </a>
          ,
          <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html" rel="noopener noreferrer" target="_blank">
           matplotlib
           <code>
            xlabel
           </code>
          </a>
          )
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l3-c12-transforms1.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          In the plot on the left, the few data points with value above 1000 mash the majority of the points into the bins on the far left. With the plot on the right, the logarithmic transform makes those large points look in line with the rest: a raw value of 1000 becomes a value of 3 under log transform, and a raw value of 100 becomes a log-transformed value of 2. The big problem with the right-side plot is that the units on the x-axis are difficult to interpret: for most people, it is only easy to convert from log values to natural values on the integers (and this assumes a nice base like 10 as used in the example).
         </p>
         <p>
          This is where scale transformations are handy. In a scale transformation, the gaps between values are based on the transformed scale, but you can interpret data in the variable's natural units. It is also a convenient approach since you won't need to engineer new features. Matplotlib's
          <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xscale.html" rel="noopener noreferrer" target="_blank">
           <code>
            xscale
           </code>
          </a>
          function includes a few built-in transformations: we'll use the 'log' scale here.
         </p>
         <pre><code class="python language-python">bin_edges = np.arange(0, data.max()+100, 100)
plt.hist(data, bins = bin_edges)
plt.xscale('log')</code></pre>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l3-c12-transforms2.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Notice two things about the plot now. Even though the data is on a log scale, the bins are still linearly spaced. This means that they change size from wide on the left to thin on the right, as the values increase multiplicatively. Secondly, the default label settings are still somewhat tricky to interpret, and are sparse as well.
         </p>
         <p>
          To address the bin size issue, we just need to change them so that they are evenly-spaced powers of 10. Depending on what you are plotting, a different base power like 2 might be useful instead. For the ticks, we can use
          <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xticks.html" rel="noopener noreferrer" target="_blank">
           <code>
            xticks
           </code>
          </a>
          to specify locations and labels in their natural units. Remember: we aren't changing the values taken by the data, only how they're displayed. Between integer powers of 10, we don't have clean values for even markings, but we can still get close. Setting ticks in cycles of 1-3-10 or 1-2-5-10 are very useful for base-10 log transforms.
         </p>
         <pre><code class="python language-python">bin_edges = 10 ** np.arange(0.8, np.log10(data.max())+0.1, 0.1)
plt.hist(data, bins = bin_edges)
plt.xscale('log')
tick_locs = [10, 30, 100, 300, 1000, 3000]
plt.xticks(tick_locs, tick_locs)</code></pre>
         <p>
          It is important that the
          <code>
           xticks
          </code>
          are specified
          <em>
           after
          </em>
          <code>
           xscale
          </code>
          since that function has its own built-in tick settings.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l3-c12-transforms3.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          We've ended up with the same plot as when we performed the direct log transform, but now with a much nicer set of tick marks and labels.
         </p>
         <h2 id="alternative-approach">
          Alternative Approach
         </h2>
         <p>
          Be aware that a logarithmic transformation is not the only one possible. When we perform a logarithmic transformation, our data values have to all be positive; it's impossible to take a log of zero or a negative number. In addition, the transformation implies that additive steps on the log scale will result in multiplicative changes in the natural scale, an important implication when it comes to data modeling. The type of transformation that you choose may be informed by the context for the data. For example,
          <a href="https://en.wikipedia.org/wiki/Log-normal_distribution#Occurrence_and_applications" rel="noopener noreferrer" target="_blank">
           this Wikipedia section
          </a>
          provides a few examples of places where log-normal distributions have been observed.
         </p>
         <p>
          If you want to use a different transformation that's not available in
          <code>
           xscale
          </code>
          , then you'll have to perform some feature engineering. In cases like this, we want to be systematic by writing a function that applies both the transformation and its inverse. The inverse will be useful in cases where we specify values in their transformed units and need to get the natural units back. For the purposes of demonstration, let's say that we want to try plotting the above data on a square-root transformation. (Perhaps the numbers represent areas, and we think it makes sense to model the data on a rough estimation of radius, length, or some other 1-d dimension.) We can create a visualization on this transformed scale like this:
         </p>
         <pre><code class="python language-python">def sqrt_trans(x, inverse = False):
    """ transformation helper function """
    if not inverse:
        return np.sqrt(x)
    else:
        return x ** 2

bin_edges = np.arange(0, sqrt_trans(data.max())+1, 1)
plt.hist(data.apply(sqrt_trans), bins = bin_edges)
tick_locs = np.arange(0, sqrt_trans(data.max())+10, 10)
plt.xticks(tick_locs, sqrt_trans(tick_locs, inverse = True).astype(int))</code></pre>
         <p>
          Note that
          <code>
           data
          </code>
          is a pandas Series, so we can use the
          <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.apply.html" rel="noopener noreferrer" target="_blank">
           <code>
            apply
           </code>
          </a>
          method for the function. If it were a NumPy Array, we would need to apply the function like in the other cases. The tick locations could have also been specified with the natural values, where we apply the standard transformation function on the first argument of
          <code>
           xticks
          </code>
          instead.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l3-c12-transforms4.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="14. Scales and Transformations Practice.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('13. Scales and Transformations')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
