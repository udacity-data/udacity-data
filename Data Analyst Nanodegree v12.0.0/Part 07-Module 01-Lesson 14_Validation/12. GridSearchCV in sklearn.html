<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   GridSearchCV in sklearn
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Validation
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Cross Validation for Fun and Profit.html">
       01. Cross Validation for Fun and Profit
      </a>
     </li>
     <li class="">
      <a href="02. Benefits of Testing.html">
       02. Benefits of Testing
      </a>
     </li>
     <li class="">
      <a href="03. TrainTest Split in sklearn.html">
       03. Train/Test Split in sklearn
      </a>
     </li>
     <li class="">
      <a href="04. Where to use training vs. testing data 1.html">
       04. Where to use training vs. testing data 1
      </a>
     </li>
     <li class="">
      <a href="05. Where to use training vs. testing data 2.html">
       05. Where to use training vs. testing data 2
      </a>
     </li>
     <li class="">
      <a href="06. Where to use training vs. testing data 3.html">
       06. Where to use training vs. testing data 3
      </a>
     </li>
     <li class="">
      <a href="07. Where to use training vs. testing data 4.html">
       07. Where to use training vs. testing data 4
      </a>
     </li>
     <li class="">
      <a href="08. K-Fold Cross Validation.html">
       08. K-Fold Cross Validation
      </a>
     </li>
     <li class="">
      <a href="09. K-Fold CV in sklearn.html">
       09. K-Fold CV in sklearn
      </a>
     </li>
     <li class="">
      <a href="10. Practical Advice for K-Fold in sklearn.html">
       10. Practical Advice for K-Fold in sklearn
      </a>
     </li>
     <li class="">
      <a href="11. Cross Validation for Parameter Tuning.html">
       11. Cross Validation for Parameter Tuning
      </a>
     </li>
     <li class="">
      <a href="12. GridSearchCV in sklearn.html">
       12. GridSearchCV in sklearn
      </a>
     </li>
     <li class="">
      <a href="13. GridSearchCV in sklearn.html">
       13. GridSearchCV in sklearn
      </a>
     </li>
     <li class="">
      <a href="14. On to the Validation Mini-Project.html">
       14. On to the Validation Mini-Project
      </a>
     </li>
     <li class="">
      <a href="15. Validation Mini-Project Video.html">
       15. Validation Mini-Project Video
      </a>
     </li>
     <li class="">
      <a href="16. Validation Mini-Project.html">
       16. Validation Mini-Project
      </a>
     </li>
     <li class="">
      <a href="17. Your First (Overfit) POI Identifier.html">
       17. Your First (Overfit) POI Identifier
      </a>
     </li>
     <li class="">
      <a href="18. Deploying a TrainingTesting Regime.html">
       18. Deploying a Training/Testing Regime
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          12. GridSearchCV in sklearn
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
         <p>
          GridSearchCV in sklearn
         </p>
        </h3>
        <div>
         <p>
          GridSearchCV is a way of systematically working through multiple combinations of parameter tunes, cross-validating as it goes to determine which tune gives the best performance.  The beauty is that it can work through many combinations in only a couple extra lines of code.
         </p>
         <p>
          Here's an example from the sklearn
          <a href="http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.GridSearchCV.html" rel="noopener noreferrer" target="_blank">
           documentation
          </a>
          :
         </p>
         <p>
          <code>
           parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10]}
          </code>
          <br/>
          <br>
           <code>
            svr = svm.SVC()
           </code>
           <br/>
           <br>
            <code>
             clf = grid_search.GridSearchCV(svr, parameters)
            </code>
            <br/>
            <br>
             <code>
              clf.fit(iris.data, iris.target)
             </code>
            </br>
           </br>
          </br>
         </p>
         <p>
          Let's break this down line by line.
          <br/>
          <br/>
          <br>
           <code>
            parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10]}
           </code>
           <br/>
           A dictionary of the parameters, and the possible values they may take.  In this case, they're playing around with the kernel (possible choices are 'linear' and 'rbf'), and C (possible choices are 1 and 10).
          </br>
         </p>
         <p>
          Then a 'grid' of all the following combinations of values for (kernel, C) are automatically generated:
         </p>
         <p>
          | ('rbf', 1) | ('rbf', 10)|
          <br>
           |-
           <br>
            | ('linear', 1) | ('linear', 10) |
           </br>
          </br>
         </p>
         <p>
          Each is used to train an SVM, and the performance is then assessed using cross-validation.
         </p>
         <p>
          <code>
           svr = svm.SVC()
          </code>
          <br/>
          <br>
           This looks kind of like creating a classifier, just like we've been doing since the first lesson.  But note that the "clf" isn't made until the next line--this is just saying what kind of algorithm to use.  Another way to think about this is that the "classifier" isn't just the algorithm in this case, it's algorithm plus parameter values.  Note that there's no monkeying around with the kernel or C; all that is handled in the next line.
          </br>
         </p>
         <p>
          <code>
           clf = grid_search.GridSearchCV(svr, parameters)
          </code>
          <br/>
          <br>
           This is where the first bit of magic happens; the classifier is being created.  We pass the algorithm (
           <i>
            svr
           </i>
           ) and the dictionary of parameters to try (
           <i>
            parameters
           </i>
           ) and it generates a grid of parameter combinations to try.
           <br/>
          </br>
         </p>
         <p>
          <code>
           clf.fit(iris.data, iris.target)
          </code>
          <br/>
          And the second bit of magic.  The fit function now tries all the parameter combinations, and returns a fitted classifier that's automatically tuned to the optimal parameter combination.  You can now access the parameter values via
          <code>
           clf.best_params_
          </code>
          .
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="13. GridSearchCV in sklearn.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('12. GridSearchCV in sklearn')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
