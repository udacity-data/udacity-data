<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Other Adaptations of Bivariate Plots
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Multivariate Exploration of Data
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Introduction.html">
       01. Introduction
      </a>
     </li>
     <li class="">
      <a href="02. Non-Positional Encodings for Third Variables.html">
       02. Non-Positional Encodings for Third Variables
      </a>
     </li>
     <li class="">
      <a href="03. Color Palettes.html">
       03. Color Palettes
      </a>
     </li>
     <li class="">
      <a href="04. Encodings Practice.html">
       04. Encodings Practice
      </a>
     </li>
     <li class="">
      <a href="05. Faceting in Two Directions.html">
       05. Faceting in Two Directions
      </a>
     </li>
     <li class="">
      <a href="06. Other Adaptations of Bivariate Plots.html">
       06. Other Adaptations of Bivariate Plots
      </a>
     </li>
     <li class="">
      <a href="07. Adapted Plot Practice.html">
       07. Adapted Plot Practice
      </a>
     </li>
     <li class="">
      <a href="08. Plot Matrices.html">
       08. Plot Matrices
      </a>
     </li>
     <li class="">
      <a href="09. Feature Engineering.html">
       09. Feature Engineering
      </a>
     </li>
     <li class="">
      <a href="10. How Much is Too Much.html">
       10. How Much is Too Much?
      </a>
     </li>
     <li class="">
      <a href="11. Additional Plot Practice.html">
       11. Additional Plot Practice
      </a>
     </li>
     <li class="">
      <a href="12. Lesson Summary.html">
       12. Lesson Summary
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          06. Other Adaptations of Bivariate Plots
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
         <p>
          L5 061 Other Adaptations Of Bivariate Plots V3
         </p>
        </h3>
        <video controls="">
         <source src="06. L5 061 Other Adaptations Of Bivariate Plots V3-qanSZttNzFM.mp4" type="video/mp4"/>
         <track default="true" kind="subtitles" label="en" src="06. L5 061 Other Adaptations Of Bivariate Plots V3-qanSZttNzFM.en.vtt" srclang="en"/>
         <track default="false" kind="subtitles" label="BR" src="06. L5 061 Other Adaptations Of Bivariate Plots V3-qanSZttNzFM.pt-BR.vtt" srclang="BR"/>
         <track default="false" kind="subtitles" label="CN" src="06. L5 061 Other Adaptations Of Bivariate Plots V3-qanSZttNzFM.zh-CN.vtt" srclang="CN"/>
        </video>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <hr/>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
         <p>
          DataVis L5C06 V2
         </p>
        </h3>
        <video controls="">
         <source src="06. DataVis L5C06 V2-BzzTlWHMyV0.mp4" type="video/mp4"/>
         <track default="true" kind="subtitles" label="en" src="06. DataVis L5C06 V2-BzzTlWHMyV0.en.vtt" srclang="en"/>
         <track default="false" kind="subtitles" label="BR" src="06. DataVis L5C06 V2-BzzTlWHMyV0.pt-BR.vtt" srclang="BR"/>
         <track default="false" kind="subtitles" label="CN" src="06. DataVis L5C06 V2-BzzTlWHMyV0.zh-CN.vtt" srclang="CN"/>
        </video>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <hr/>
         <h2 id="other-adaptations-of-bivariate-plots">
          Other Adaptations of Bivariate Plots
         </h2>
         <p>
          You also saw one other way of expanding univariate plots into bivariate plots in the previous lesson: substituting count on a bar chart or histogram for the mean, median, or some other statistic of a second variable. This adaptation can also be done for bivariate plots like the heat map, clustered bar chart, and line plot, to allow them to depict multivariate relationships.
         </p>
         <p>
          If we want to depict the mean of a third variable in a
          <strong>
           2-d histogram
          </strong>
          , we need to change the weights of points in the
          <code>
           hist2d
          </code>
          function similar to how we changed the weights in the 1-d histogram.
         </p>
         <pre><code class="python language-python">xbin_edges = np.arange(0.25, df['num_var1'].max()+0.5, 0.5)
ybin_edges = np.arange(7,    df['num_var2'].max()+0.5, 0.5)

# count number of points in each bin
xbin_idxs = pd.cut(df['num_var1'], xbin_edges, right = False,
                    include_lowest = True, labels = False).astype(int)
ybin_idxs = pd.cut(df['num_var2'], ybin_edges, right = False,
                    include_lowest = True, labels = False).astype(int)

pts_per_bin = df.groupby([xbin_idxs, ybin_idxs]).size()
pts_per_bin = pts_per_bin.reset_index()
pts_per_bin = pts_per_bin.pivot(index = 'num_var1', columns = 'num_var2').values

z_wts = df['num_var3'] / pts_per_bin[xbin_idxs, ybin_idxs]

# plot the data using the calculated weights
plt.hist2d(data = df, x = 'num_var1', y = 'num_var2', weights = z_wts,
           bins = [xbin_edges, ybin_edges], cmap = 'viridis_r', cmin = 0.5);
plt.xlabel('num_var1')
plt.ylabel('num_var2');
plt.colorbar(label = 'mean(num_var3)');</code></pre>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l5-c06-adaptations1.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Considering how few data points there are in the example, and how cleanly the third variable is distributed, the adapted heat map is a bit excessive in terms of work. The low level of point overlap observed earlier means that the scatterplot with color or size encoding was sufficient for depicting the data. You'll be more likely to use the heat map if there is a lot of data to be aggregated.
         </p>
         <p>
          The code for the
          <strong>
           2-d bar chart
          </strong>
          doesn't actually change much. The actual
          <code>
           heatmap
          </code>
          call is still the same, only the aggregation of values changes. Instead of taking
          <code>
           size
          </code>
          after the
          <code>
           groupby
          </code>
          operation, we compute the
          <code>
           mean
          </code>
          across dataframe columns and isolate the column of interest.
         </p>
         <pre><code class="python language-python">cat_means = df.groupby(['cat_var1', 'cat_var2']).mean()['num_var2']
cat_means = cat_means.reset_index(name = 'num_var2_avg')
cat_means = cat_means.pivot(index = 'cat_var2', columns = 'cat_var1',
                            values = 'num_var2_avg')
sb.heatmap(cat_means, annot = True, fmt = '.3f',
           cbar_kws = {'label' : 'mean(num_var2)'})</code></pre>
         <p>
          Note how the "cbar_kws" provides an additional argument to the colorbar component of the heat map call.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l5-c06-adaptations2.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          An alternative approach for two categorical variables and one numeric variable is to adapt a
          <strong>
           clustered bar chart
          </strong>
          using the
          <code>
           barplot
          </code>
          function instead of the
          <code>
           countplot
          </code>
          function:
         </p>
         <pre><code class="python language-python">ax = sb.barplot(data = df, x = 'cat_var1', y = 'num_var2', hue = 'cat_var2')
ax.legend(loc = 8, ncol = 3, framealpha = 1, title = 'cat_var2')</code></pre>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l5-c06-adaptations3.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          The "hue" parameter can also be used in a similar fashion in the
          <code>
           boxplot
          </code>
          ,
          <code>
           violinplot
          </code>
          , and
          <code>
           pointplot
          </code>
          functions to add a categorical third variable to those plots in a clustered fashion. As a special note for
          <code>
           pointplot
          </code>
          , the default rendering aligns all levels of the "hue" categorical variable vertically. Use the "dodge" parameter to shift the levels in a clustered fashion:
         </p>
         <pre><code class="python language-python">ax = sb.pointplot(data = df, x = 'cat_var1', y = 'num_var2', hue = 'cat_var2',
                  dodge = 0.3, linestyles = "")</code></pre>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l5-c06-adaptations4.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          As a final example, a
          <strong>
           line plot
          </strong>
          can be adapted from previous code showing how to create frequency polygons for levels of a categorical variable. In this case as well, we create a custom function to send to a
          <strong>
           FacetGrid
          </strong>
          object's
          <code>
           map
          </code>
          function that computes the means in each bin, then plots them as lines via
          <code>
           errorbar
          </code>
          .
         </p>
         <pre><code class="python language-python">def mean_poly(x, y, bins = 10, **kwargs):
    """ Custom adapted line plot code. """
    # set bin edges if none or int specified
    if type(bins) == int:
        bins = np.linspace(x.min(), x.max(), bins+1)
    bin_centers = (bin_edges[1:] + bin_edges[:-1]) / 2

    # compute counts
    data_bins = pd.cut(x, bins, right = False,
                       include_lowest = True)
    means = y.groupby(data_bins).mean()

    # create plot
    plt.errorbar(x = bin_centers, y = means, **kwargs)

bin_edges = np.arange(0.25, df['num_var1'].max()+0.5, 0.5)
g = sb.FacetGrid(data = df, hue = 'cat_var2', size = 5)
g.map(mean_poly, "num_var1", "num_var2", bins = bin_edges)
g.set_ylabels('mean(num_var2)')
g.add_legend()</code></pre>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/l5-c06-adaptations5.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="07. Adapted Plot Practice.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('06. Other Adaptations of Bivariate Plots')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
