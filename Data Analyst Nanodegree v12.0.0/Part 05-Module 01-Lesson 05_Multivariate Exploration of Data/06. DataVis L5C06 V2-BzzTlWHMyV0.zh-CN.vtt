WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:01.480
在上次课程中

00:00:01.480 --> 00:00:04.410
我们学习了如何使用 barplot 和 pointplot 函数绘制条形图

00:00:04.410 --> 00:00:07.845
主要是将第二个变量的平均值画到纵轴上

00:00:07.844 --> 00:00:11.070
让我们加入变速器类型

00:00:11.070 --> 00:00:15.365
将有关燃油效率和车辆类型的双变量图表扩展成多变量图表

00:00:15.365 --> 00:00:20.495
我们只需要在 pointplot 函数中添加 hue = ‘trans_type’ 参数

00:00:20.495 --> 00:00:22.820
因为点和长条之间相互重叠

00:00:22.820 --> 00:00:26.734
我们需要添加 dodge = True 参数 使两种类别互相偏移一点

00:00:26.734 --> 00:00:30.969
我们还可以将 pointplot 改为 barplot

00:00:30.969 --> 00:00:33.509
得到一个分组条形图

00:00:33.509 --> 00:00:36.359
我们甚至还可以再进一步

00:00:36.359 --> 00:00:41.869
使用箱线图 从而得到一个分组箱线图

00:00:42.219 --> 00:00:45.019
热图也可以做出调整

00:00:45.020 --> 00:00:47.400
让颜色编码 基于第三变量的平均值

00:00:47.399 --> 00:00:50.239
而不是计数

00:00:50.240 --> 00:00:54.020
让我们来修改这幅有关燃油效率和发动机排量大小的热图

00:00:54.020 --> 00:00:57.040
使二氧化碳排放量的均值也能在图上展示

00:00:57.039 --> 00:00:59.780
hist2d 函数有一个 weights 参数

00:00:59.780 --> 00:01:02.870
设置每个数据在聚合时的权重

00:01:02.869 --> 00:01:05.914
默认的权重为 1

00:01:05.915 --> 00:01:08.425
所以颜色代表了数据点的数量

00:01:08.424 --> 00:01:11.209
如果我们将这里的 weights 改成二氧化碳排放量

00:01:11.209 --> 00:01:14.659
除以每个分组的汽车数量

00:01:14.659 --> 00:01:18.844
这样每一个分组的总和就是二氧化碳排放量的均值

00:01:18.844 --> 00:01:22.625
我们的第 1 步是对数据进行分组

00:01:22.625 --> 00:01:25.495
使用 Pandas 里的 cut 函数

00:01:25.495 --> 00:01:28.100
除了之前看到过的参数

00:01:28.099 --> 00:01:32.409
我们将 labels 参数改为 False 使每个分组的索引为数值索引

00:01:32.409 --> 00:01:36.375
用 astype 使数据类型变成整数型 使后续的索引变得更简单

00:01:36.375 --> 00:01:40.465
之后我们统计每个分组里的数据量

00:01:40.465 --> 00:01:44.020
这可以通过使用 groupby 和 size 函数得到

00:01:44.019 --> 00:01:47.539
多重索引的 Series 类型不是很方便使用

00:01:47.540 --> 00:01:51.925
所以我们再用 reset_index 和 pivot 方法将计数变成数组的形式

00:01:51.924 --> 00:01:57.250
最后 我们使用 values 属性将数据计数变成一个数组

00:01:57.250 --> 00:02:00.810
现在 我们得到了计算权重需要的所有数据

00:02:00.810 --> 00:02:05.745
我们用 co2 Series 除以每个分组的数据量

00:02:05.745 --> 00:02:10.349
利用 cut 分组的索引确保向量除法中的每个元素都相互对应

00:02:10.419 --> 00:02:13.544
然后我们将其加入 weights 参数

00:02:13.544 --> 00:02:15.089
并为颜色条添加了标签

00:02:15.090 --> 00:02:17.240
最终得到了和我们之间课上画过的散点图

00:02:17.240 --> 00:02:20.400
一致的热图

